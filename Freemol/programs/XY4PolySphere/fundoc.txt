  
  -----------------------------------------------------------------------------
  -----------------------------------------------------------------------------
   MODULE metpot4
  -----------------------------------------------------------------------------
   This File is part of the Frimol package
   (C) 2003 Fabio Mariotti, <fabio.mariotti@scriptsforscience.org>
   Please read the full copyright statment in the COPYING file
  -----------------------------------------------------------------------------
   $Id: metpot4.F90,v 1.1.1.1 2009/01/12 16:56:08 mariotti Exp $
  -----------------------------------------------------------------------------
  
  
  
   Original copyright statment
  
   ============================================================================
  
    ! potential model METPOT4 for methane and subgroups
    ! version 31AUG97
    !  authors
    !         ----------------------------------------
    !        | Roberto Marquardt and Martin Quack     |
    !        | Laboratorium fuer Physikalische Chemie |
    !        | ETH-Zuerich(Zentrum)                   |
    !        | 8092 Zuerich                           |
    !        |                                        |
    !        | roma@phys.chem.ethz.ch                 |
    !         ----------------------------------------
    !-----------------------------------------------------------------------
  
   ============================================================================
  
  
  -----------------------------------------------------------------------------
  -----------------------------------------------------------------------------
   Function metpot4_init()
  -----------------------------------------------------------------------------
  
  
  -----------------------------------------------------------------------------
  
   This routine initialize the metpot4 module.
  
  -----------------------------------------------------------------------------
  
  
  -----------------------------------------------------------------------------
   logical function metpot4_isinit()
  -----------------------------------------------------------------------------
  
  
  -----------------------------------------------------------------------------
   We merelyreturn the initialization flag.
  -----------------------------------------------------------------------------
  
  
  -----------------------------------------------------------------------------
   subroutine metpot4_vint(RINT,V)
  -----------------------------------------------------------------------------
  
  
  -----------------------------------------------------------------------------
  -----------------------------------------------------------------------------
   subroutine metpot4_initpot()
  -----------------------------------------------------------------------------
  
  
  -----------------------------------------------------------------------------
  
   This routine initialize the metpot4 potential: default values.
  
   Old comment: ! definition of molecule specific potential parameters
  
  -----------------------------------------------------------------------------
  
  
  -----------------------------------------------------------------------------
  -----------------------------------------------------------------------------
   PROGRAM XY4PolySphere  Frimol by F.Mariotti:
  -----------------------------------------------------------------------------
   $Id: XY4PolySphere.F90,v 1.1.1.1 2009/01/12 16:56:08 mariotti Exp $
  -----------------------------------------------------------------------------
   This File is part of the Frimol package
   (C) 2003 Fabio Mariotti, <fabio.mariotti@scriptsforscience.org>
   Please read the full copyright statment in the COPYING file
  -----------------------------------------------------------------------------
   
   DESCRIPTION:
    We implement some stuff from JCP 119,11513 plus some our tests and so on..
   
   TODO: 
   
   
   WARN: 
   
  
  -----------------------------------------------------------------------------
  -----------------------------------------------------------------------------
   
  
  -----------------------------------------------------------------------------
  -----------------------------------------------------------------------------
   integer(FINT) function poly2cart
  -----------------------------------------------------------------------------
  
  
  -----------------------------------------------------------------------------
  
   This routine 
  
  -----------------------------------------------------------------------------
  
  
  -----------------------------------------------------------------------------
  -----------------------------------------------------------------------------
   subroutine getbonds(n,lvx,lvr,debug)
  -----------------------------------------------------------------------------
  
  
  -----------------------------------------------------------------------------
  
   This routine returns bond lenghts from central atom at origin.
  
  -----------------------------------------------------------------------------
  
  
  -----------------------------------------------------------------------------
  -----------------------------------------------------------------------------
   subroutine getangles(n,lvx,lvr,lva,debug)
  -----------------------------------------------------------------------------
  
  
  -----------------------------------------------------------------------------
  
   This routine returns angles between vectors of catersian atoms from origin.
   Order is defined by the loop check it or btw a12 a13 a14 a23 a24 a34 on 4 
  
  -----------------------------------------------------------------------------
  
  
  -----------------------------------------------------------------------------
  -----------------------------------------------------------------------------
   subroutine XXXX
  -----------------------------------------------------------------------------
  
  
  -----------------------------------------------------------------------------
  
   This routine 
  
  -----------------------------------------------------------------------------
  
  
  -----------------------------------------------------------------------------
  -----------------------------------------------------------------------------
   Function XY4PolySphere_init()
  -----------------------------------------------------------------------------
  
  
  -----------------------------------------------------------------------------
  
   This routine initialize the XY4PolySphere module.
  
  -----------------------------------------------------------------------------
  
  
  -----------------------------------------------------------------------------
   logical function XY4PolySphere_isinit()
  -----------------------------------------------------------------------------
  
  
  -----------------------------------------------------------------------------
   We merelyreturn the initialization flag.
  -----------------------------------------------------------------------------
  
  
  -----------------------------------------------------------------------------
  -----------------------------------------------------------------------------
   character(FLCHARS) function XY4PolySphere_geterror()
  -----------------------------------------------------------------------------
  
  
  -----------------------------------------------------------------------------
   
   Return the error code of the program in Object oriented
   programming style. It is a part of a set of routine to return errors.
   See the discussion in the interface.
   
  -----------------------------------------------------------------------------
  
  
  -----------------------------------------------------------------------------
  
  
  -----------------------------------------------------------------------------
  -----------------------------------------------------------------------------
   real(FREAL) function chk_rangevol(ranrange,vol)
  -----------------------------------------------------------------------------
  
   In simple words.. This function return the potential: with a negative
   sign if it is over the given limit (which is read from the external vlimit)
   It does also return a volume for the given coordinates. It does distinguish
   the r(1:4) and the a(5:9) via an hardcoded scale factor which is now=1.0.
   Volume is given back as a vector=(total,rvolume,avolume,scalefactor)
  
